\chapter{Wyznaczanie średnicy\label{chap:diameter}}
Problem średnicy dowolnego zbioru punktów można przedstawić
następująco: mając danych $N$ punktów na płaszczyźnie, znaleźć dwa
punkty najbardziej odległe od siebie. Problem można rozwiązać metodą
naiwną wyznaczając odległość wszystkich $N(N-1)/2$ par punktów i
wybierając największą z nich. Naturalnym jest jednak szukanie bardziej
efektywnych rozwiązań.

Aby uniknąć badania wszystkich par punktów, można skorzystać z
twierdzenia~\ref{thm:hy61}, do wyznaczenia otoczki wypukłą zbioru
punktów w czasie $O(n \log n)$\cite{Graham72}, a następnie wyznaczając jej średnicę.

\begin{twierdzenie}[Hocking-Young 1961~\cite{HockYou61}\label{thm:hy61}]
  Średnica zbioru jest równa średnicy jego otoczki wypukłej.
\end{twierdzenie}

Wiemy, że zbiór wierzchołków wielokąta wypukłego jest jego otoczką
wypukłą, dlatego zdefiniujmy następujący problem.

\begin{problem}[Średnica wielokąta wypukłego]
  Jeśli dany jest wielokąt wypukły, znaleźć jego średnicę,
  tj.\ największą odległość pomiędzy dowolną parą jego wierzchołków.
\end{problem}

Kluczowym dla algorytmu korzystającego z wypukłości wielokąta przy
wyznaczaniu średnicy jest następujące twierdzenie.

\begin{twierdzenie}[Yaglom-Boltyanskii 1961~\cite{YagBol61}]
\label{thm:yagbol}
  Średnica wielokąta wypukłego jest największą odległością między parą
  równoległych prostych wspierających.
\end{twierdzenie}

Proste wspierające nie mogą przechodzić przez każdą parę punktów. Na
przykład żadne proste wpierające przechodzące przez $p_0$ i $p_5$
wielokąta z rysunku~\ref{fig:antipodal} nie mogą być równoległe, więc
$(p_{0},p_{5})$ nie jest średnicą. Przypomnijmy --- para punktów,
przez które mogą przechodzić proste wspierające, jest nazywana
punktami antypodycznymi. Z twierdzenia~\ref{thm:yagbol} wynika, że
szukając średnicy nie musimy badać wszystkich par punktów, a jedynie
pary antypodyczne.

\begin{figure}[htp]
  \centering
  \begin{tikzpicture}[scale=0.8]
    \convexA

    \node [anchor=center,circle,draw,fill,inner sep=0.5pt,
    label={right:$p_0$}] at (p0) {};

    \node [anchor=center,circle,draw,fill,inner sep=0.5pt,
    label={45:$p_1$}] at (p1) {};

    \node [anchor=center,circle,draw,fill,inner
    sep=0.5pt,label={above:$p_2$}] at (p2) {};

    \node [anchor=center,circle,draw,fill,inner
    sep=0.5pt,label={135:$p_3$}] at (p3) {};

    \node [anchor=center,circle,draw,fill,inner
    sep=0.5pt,label={left:$p_4$}] at (p4) {};

    \node [anchor=center,circle,draw,fill,inner
    sep=0.5pt,label={below:$p_5$}] at (p5) {};

    \node [anchor=center,circle,draw,fill,inner
    sep=0.5pt,label={315:$p_6$}] at (p6) {};

  \end{tikzpicture}
  \caption{\label{fig:antipodal}}
\end{figure}

Przedstawiony zostanie teraz sposób znajdowania par punktów
antypodycznych. Rozważmy wielokąt przedstawiony na
rysunku~\ref{fig:antipodal}. Wybieramy dowolny wierzchołek $p_i$ i
przechodzimy w kierunku przeciwnym do ruchu wskazówek zegara po brzegu
wielokąta tak długo, aż dojdziemy do wierzchołka $q_r$, który jest
najdalej od prostej zawierającej krawędź $p_{i}p_{i-1}$. W taki sam
sposób wyznaczamy wierzchołek $q_l$ jako najdalszy od $p_{i}p_{i+1}$
przechodząc po brzegu wielokąta zgodnie z ruchem wskazówek
zegara. Łańcuch $C(p_i)$ wierzchołków od $q_r$ do $q_l$, z nimi samymi
włącznie, tworzy zbiór wierzchołków, z których każdy tworzy parę
antypodyczną z $p_i$. Możemy zauważyć, że ($p_{i},p_{r}$) jest parą
antypodyczną wyłącznie wtedy, gdy istnieje prosta przecinająca $\angle
\alpha_i$ i $\angle \alpha_s$ (rysunek~\ref{fig:diameter}). Ze względu
na to, że $C(p_i)$ jest łańcuchem wypukłym, każdy wierzchołek $p_s$
należący do $C(p_i)$ jest antypodyczny do $p_i$, a żaden wierzchołek
nienależący do $C(p_i)$ takim nie jest. Fakt ten umożliwia konstrukcję
algorytmu pozwalającego efektywnie uzyskać wszystkie pary
antypodyczne.

\begin{figure}[htp]
  \centering
  \includegraphics[width=0.3\textwidth]{img/diameter}
  \caption{Rysunek roboczy\label{fig:diameter}}
\end{figure}

Wejściem dla algorytmu jest wielokąt zadany jako lista wierzchołków ze
wskaźnikiem na swój następnik w kolejności przeciwnej do ruchu
wskazówek zegara --- następnikiem wierzchołka $p_n$ jest $p_1$. Dla
czytelności algorytmu przyjmijmy także, że żadna para boków tego
wielokąta nie jest równoległa. Do określenia, który punkt leży
najdalej od odcinka $p_{0}p_{i+1}$, korzystamy funkcji ,,pola ze
znakiem trójkąta'' $p_{0}p_{i+1}p$, którą przedstawiono w
rozdziale~\ref{chap:pojecia} do wyznaczenia skrętności kąta. W
pierwszej części algorytmu w pętli \texttt{while} szukamy pierwszego
najdalszego wierzchołka i oznaczamy go jako $q_0$. Następnie
wyznaczamy łańcuch $C(p_i)$, używając wskaźników $p$ i $q$
poruszających się w kierunku odwrotnym do ruchu wskazówek zegara,
zaczynając odpowiednio od $p_0$ i $q_0$ do momentu, aż wskaźnik $q$
wróci do pozycji $p_0$. Po tym kroku zostaną wypisane wszystkie pary
antypodyczne. Znalezienie wierzchołka $q_0$ zajmuje w pesymistycznym
przypadku $N-1$ kroków, natomiast przejście po łańuchach $p_{0},
\ldots, q_{0}$ i $q_{0}, \ldots, p_{0}$ łącznie $N$ kroków. Mamy więc
do czynienia ze złożonością czasową rzędu $O(N)$.

% Specjalną sytuacją jest przypadek, gdy dwie krawędzie są równoległe
% (wtedy pole ze znakiem trójkąta jest równe dla dwóch wierzchołków
% tworzących krawędź równoległą), która wymaga od nas dodatkowego kroku
% przy każdym wierzchołku (wiersze 15--19).

% Poprawność algorytmu wynika z tego, że krawędzi równoległych jest co
% najwyżej $N/2$, więc łącznie algorytm nie wykonuje więcej niż $3N$
% kroków. Mamy więc do czynienia ze złożonością czasową rzędu $O(n)$.

Fakt, że punkt antypodyczny dla punktu $p_{i+1}$ nie może być bliższy
niż wierzchołek, który jest najdalej od $p_i$, wynika z wypukłością
wielokąta --- dla dowolnego wierzchołka $p$ można wyznaczyć taki
wierzchołek $q$, że odległość kolejnych wierzchołków od $p$ do $q$
jest nierosnąca, zaś od $q$ do $p$ niemalejąca.

\begin{figure}[htp]

  \begin{algorithmic}[1]
    \Procedure{Antipodal Pairs}{}

    \State $p \gets p_N$
    \State $q \gets NEXT[p]$

    \State

    \While {$NEXT[q]$ jest dalej od $(p, NEXT[p])$ niż $q$}
        \State {(znajdźmy wierzchołek najdalszy od $(p, NEXT[p])$)}
        \State{$q \gets NEXT[p]$}

        \State

        \State {(oznaczmy go jako $q_0$)}
        \State {$q_0 \gets q$}

        \State

        \While {$q \neq p_0$}
                \State {$p \gets NEXT[p]$}

                \State $print (p, q)$

                \State

                \While {$NEXT[q]$ jest dalej od $(p, NEXT[p])$ niż $q$}
                        \State $q \gets NEXT[q]$

                        \State

                        \State {(jeżeli nie wróciliśmy do pozycji początkowej)}
                        \If {$(p, q) \neq (q_0,p_0)$}
                                \State $print (p, q)$
                        \EndIf
                \EndWhile
         \EndWhile
     \EndWhile
\EndProcedure

  \end{algorithmic}
  \caption{\label{alg:antipodal}}
\end{figure}

\begin{table}[htb]
  \centering

  \begin{tabular}{llll}
    \toprule
    $p$ & $q$ & para antypodyczna & krok \\
    \midrule
    $p_6$ & & & 1 \\
    \midrule
    & $p_0$ & & 3 \\
    \midrule
    & $p_1$ & & 5 \\
    \midrule
    & $p_2$ & & 5 \\
    \midrule
    & $p_3$ & & 5 \\
    \midrule
    $p_0$& & & 13 \\
    \midrule
    & & $(p_0, p_3)$ & 14 \\
    \midrule
    & $p_4$ & & 17 \\
    \midrule
    & & $(p_0, p_4)$ & 21 \\
    \midrule
    $p_1$& & & 13 \\
    \midrule
    & & $(p_1, p_4)$ & 14 \\
    \midrule
    & $p_5$ & & 17 \\
    \midrule
    & & $(p_1, p_5)$ & 21 \\
    \midrule
    $p_2$& & & 13 \\
    \midrule
    & & $(p_2, p_5)$ & 14 \\
    \midrule
    $p_3$& & & 13 \\
    \midrule
    & & $(p_3, p_5)$ & 14 \\
    \midrule
    & $p_6$ & & 17 \\
    \midrule
    & & $(p_3, p_6)$ & 21 \\
    \midrule
    & $p_0$ & & 17 \\
    \bottomrule
  \end{tabular}

  \caption{Przykład działania algorytmu  \textsc{Antipodal Pairs} dla
    wielokąta z rysunku~\ref{fig:antipodal}}
\end{table}


%%% Local Variables:
%%% mode: latex
%%% TeX-master: "masterthesis"
%%% TeX-engine: xetex
%%% End:
