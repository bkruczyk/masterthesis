\chapter{Przecięcie wielokątów}
Problem znalezienia przecięcia dla wielokątów wypukłych zdefiniujmy
następująco:

\begin{problem}[Znajdowanie przecięcia wielokątów]
  Gdy dane są dwa wielokąty wypukłe $P$ i $Q$, znaleźć ich
  \emph{przecięcie} tj.\ obszar należący jednocześnie do $P$ i do $Q$.
\end{problem}

W niniejszym rozdziale do wielokąta będziemy zaliczać jego wnętrze
wraz z brzegiem.

Oznaczmy jako $N$ liczbę wierzchołków $P$, a jako $M$ liczbę
wierzchołków $Q$. Stosując algorytm naiwny polegający na sprawdzeniu
przecięcia każdej krawędzi $P$ z każdą krawędzią $Q$ można uzyskać
punkty wszystkich przecięć w czasie $O(NM)$.

\section{Algorytm Shamos-Hoey}
Znaną metodą rozwiązywania problemów w algorytmice jest technika
\emph{dziel i rządź}, polegająca na podziale na mniejsze części,
znajdowaniu rozwiązań częściowych, a następnie łączeniu ich w końcowy
rezultat.

Metodę wykorzystującą podział płaszczyzny zaproponowali w 1976 Shamos
i Hoey. Przez każdy wierzchołek $P$ i $Q$ prowadzimy prostą równoległą
do osi $y$, tworząc w ten sposób $N+M$ warstw. Znalezienie przecięć
krawędzi obydwu wielokątów w każdej warstwie pozwoli nam na proste
wyznaczenie obszaru przecięcia tych wielokątów.

Należy zauważyć, że w każdej warstwie proste ją ograniczające wraz z
krawędziami wielokąta tworzą czworobok lub gdy jest to wierzchołek
skrajny na osi $x$ --- trójkąt. W pojedynczej warstwie przecięcie
dwóch czworoboków możemy wyznaczyć w czasie stałym. % Z twierdzenia
% \ref{thm:egdecollision} wiemy, że w każdej warstwie znajdziemy nie
% więcej niż dwa przecięcia.

% \begin{twierdzenie}
% \label{thm:egdecollision}
%   Jeżeli dwa wielokąty wypukłe $P$ i $Q$ przecinają się, to każda z
%   krawędzi $P$ przecina $Q$ co najwyżej dwa razy.
% \end{twierdzenie}

Następnie w czasie liniowym łączymy uzyskane kawałki i usuwamy
nadmiarowe wierzchołki powstałe przy podziale płaszczyzny. Początkowy
podział płaszczyzny również możemy przeprowadzić w czasie liniowym,
tak więc złożoność czasowa całego algorytmu wynosi $O(n)$.

\section{Algorytm O'Rourke-Chien-Olson-Naddor}
Kolejną metoda, zaproponowana przez O'Rourke, Chiena, Olsona i
Naddora (1982) jest rozwinięciem algorytmu naiwnego.

Załóżmy, że $P$ i $Q$ przecinają się, oraz oznaczmy ich przecięcie $P
\cap Q$ jako $R$ (\ref{fig:scythes}). Zauważmy, że brzeg $R$ składa
się naprzemiennie z krawędzi należących do $P$ i $Q$. Jeżeli dany
fragment brzegu $R$ należy do $Q$, to jest on ,,objęty'' na zewnątrz
przez fragment krawędzi $P$ i na odwrót, fragmenty brzegu $R$, które
należą do $P$ są otoczone przez krawędzie należące do $Q$.

Możemy zauważyć, że przechodząc w odpowiedniej kolejności,
jednocześnie po zewnętrznych i wewnętrznych krawędziach sierpa
ograniczymy sprawdzanie przecięć do krawędzi początkowych i końcowych
danego sierpa. Z tego względu przy wyborze krawędzi do której mamy
przejść w danym kroku, kierujemy się tym czy krawędź bieżąca może
zawierać przecięcie, które dopiero mają być wykryte.

Wybierzmy dowolną krawędź $p_{i-1}p_{i}$ z $P$ oraz dowolną krawędź
$q_{j-1}q_{j}$ z $Q$. Będziemy przechodzić po krawędziach obu
wielokątów w kierunku przeciwnym do ruch wskazówek zegara. W każdym
kroku sprawdzamy przecięcie bieżących krawędzi $P$ i $Q$, oraz
wybieramy krawędź do której podążymy w następnym kroku. Rozważmy
sytuację z rysunku \ref{fig:advance}. Wektor krawędzi $p_{i-1}p_{i}$
oznaczyliśmy jako $A$, a wektor krawędzi $q_{j-1}q_{j}$ jako $B$.
Krawędzie obu wielokątów mają szanse przeciąć się tylko, jeżeli ich
wektory są skierowane ku sobie. Ponadto, jeżeli $A \times B > 0$ i
$p_{i}$ leży w półpłaszczyźnie $H(B)$ zdefiniowanej jako obszar na
lewo od $B$, to wiemy, że powinniśmy przejść po krawędzi
$q_{j}q_{j+1}$. Tak samo w sytuacji, jeżeli $A \times B < 0$ i $p_{i}$
nie należy do $H(B)$. W przeciwnym przypadku przechodzimy po
$p_{i}p_{i+1}$.

Jeżeli $P$ i $Q$ przecinają się to przecięcie zostanie znalezione po
$O(L+M)$ krokach. Znając punkty przecięć dodatkowe $L+M$ kroków
wystarcza do wyznaczenia brzegów przecięcia. Możemy tym samym
stwierdzić, że jeżeli po $2(L+M)$ krokach nie odnajdziemy przecięcia
to krawędzie $P$ i $Q$ nie przecinają się.

\section{Algorytm Toussaint}
Stosunkowo prosty koncepcyjnie i implementacyjnie algorytm, działający
w czasie liniowym zaproponował Godfried T. Toussaint.

\subsection{Idea algorytmu}
Rozważmy dwa przecinające się, wypukłe wielokąty $P$ i $Q$, oraz
otoczkę wypukłą sumy tych wielokątów $CH(P \cup Q)$ [rys]. Niech
brzegi $P$ i $Q$ przecinają się w $k$ punktach $I_1, I_2, \ldots, I_k$
ponumerowanych zgodnie z kierunkiem przeciwnym do ruchu wskazówek
zegara. Brzegi $P$ i $Q$ oraz otoczka wypukła $CH(P \cup Q)$ dzielą
płaszczyznę na $2k + 1$ ograniczonych regionów: obszar przecięcia
wielokątów $P \cap Q$ wyznaczony przez punkty $I_1, I_2, \ldots, I_k$,
$k$ regionów gdzie $P$ lub $Q$ należy do otoczki wypukłej $CH(P \cup
Q)$, ale nie należy do obszaru $P \cap Q$ przecięcia tych wielokątów
oraz analogiczne $k$ obszarów $K_1, K_2, \ldots, K_k$, które nazywać
będziemy \emph{kieszeniami}, leżących wewnątrz otoczki wypukłej $CH(P
\cup Q$), ale leżących na zewnątrz $P \cup Q$. Każdej kieszeni $K_v$
przypisujemy odpowiadający jej punkt przecięcia $I_v$ oraz krawędź
otoczki $CH(P \cup Q)$, którą będziemy nazywać \emph{mostem}, łączącą
wierzchołek $p_i$ wielokąta $P$ oraz wierzchołek $q_j$ wielokąta $Q$ i
oznaczymy ją jako $B_{v}(p_{i_v}, q_{j_v})$. Nieformalny algorytm
można przedstawić w następujących trzech krokach:

\begin{enumerate}
\item Wyznacz otoczkę wypukłą $P \cup Q$.
\item Dla każdego mostu $B_i$ znajdź odpowiadający mu punkt przecięcia
  $I_i$ wielokątów.
\item Połącz łańcuchy wypukłe łączące sąsiednie punkty przecięcia.
\end{enumerate}

%%% Local Variables:
%%% mode: latex
%%% TeX-master: "masterthesis"
%%% TeX-engine: xetex
%%% End:
